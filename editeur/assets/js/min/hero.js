function Hero(i,t,s,e,h,a,o,l,n){this.map=i,this.x=t,this.y=s,this.life=e,this.fatigue=h,this.xp=l,this.width=i.tsize,this.height=i.tsize,this.attaque=a,this.defense=o,this.equipement=n,this.supply={ecu:0,bois:0,argile:0,ble:0,farine:2e3,fer:0,cuivre:0,pain:100},this.image=Loader.getImage("hero"),this.addBuild=function(i,t,s,e,h,a,o,l,n){var p=0,m=0;if(Keyboard.isDown(Keyboard.LEFT)?p=-1:Keyboard.isDown(Keyboard.RIGHT)?p=1:Keyboard.isDown(Keyboard.UP)?m=-1:Keyboard.isDown(Keyboard.DOWN)&&(m=1),0!=p||0!=m)return!1;var u=0;if(Object.keys(a).forEach(function(i){Game.hero.supply[i]<a[i]&&(u=1)}),0!=u)return!1;if(pos=s.getRow(t)*s.rows+s.getCol(i),abs2[pos+1]==o&&1==abs1[pos+1]){Game.hero.x=s.tsize/2+s.tsize*s.getCol(i),abs2[pos+1]=e[0];var r="build-"+s.getRow(t)+"-"+parseInt(s.getCol(i)+1,10)+"-ing";Object.keys(a).forEach(function(i){Game.hero.supply[i]=Game.hero.supply[i]-a[i]}),Game.nameBuild=new Building(s,i+32,t,s.getCol(i)+1,s.getRow(t),l,r,e,h,o,n),builds[s.getCol(i)+1+"-"+s.getRow(t)]=Game.nameBuild,anim=new animation(s,i+32,t,"cloud"),menussclick=0}},this.creuse=function(i,t,s){var e=Game._getToolEquipe(),h=this.supply.ecu,a=this.supply.bois,o=this.supply.pain,l=this.supply.farine,n=this.supply.ble,p=s.getRow(t)*s.rows+s.getCol(i),m=s.getCol(i),u=s.getRow(t);if(0==abs2[p]&&2!=abs1[p]&&"pelle"==e?(abs1[p]=2,abs2[p]=0,this.supply.ecu=h+10):2==abs1[p]&&"pelle"==e?this.supply.ecu=h+1:8!=abs2[p]&&9!=abs2[p]||1!=abs1[p]||"faux"!=e||(abs1[p]=2,abs2[p]=0,this.supply.bois=a+5),void 0!==builds[m+"-"+u]&&null!==builds[m+"-"+u]&&(void 0===builds[m+"-"+u].caracteristique.outilRecompense||builds[m+"-"+u].caracteristique.outilRecompense==e)&&abs2[p]==builds[m+"-"+u].batiment[3]){builds[m+"-"+u].life=builds[m+"-"+u].life-1,0==builds[m+"-"+u].life?(delete builds[m+"-"+u],abs1[p]=2,abs2[p]=0):(abs2[p]=builds[m+"-"+u].batiment[0],builds[m+"-"+u].day=day,builds[m+"-"+u].hour=hour);var r=builds[m+"-"+u].caracteristique.recompense;Object.keys(r).forEach(function(i){Game.hero.supply[i]+=r[i]})}this.supply.ecu>h&&(anim=new animation(s,i,t,"coin")),this.supply.bois>a&&(anim=new animation(s,i,t,"bois")),this.supply.ble>n&&(anim=new animation(s,i,t,"culture_ble")),this.supply.pain>o&&(anim=new animation(s,i,t,"pain")),this.supply.farine>l&&(anim=new animation(s,i,t,"farine"))}}Hero.SPEED=256,Hero.prototype.move=function(i,t,s){this.x+=t*Hero.SPEED*i,this.y+=s*Hero.SPEED*i,this._collide(t,s),this._ennemy(t,s),this._loselifeTile(t,s);var e=this.map.cols*this.map.tsize,h=this.map.rows*this.map.tsize;this.x=Math.max(0,Math.min(this.x,e)),this.y=Math.max(0,Math.min(this.y,h));var a=this.map.getRow(this.x),o=this.map.getCol(this.y);if((this.x>=xHeroClick+this.map.tsize||this.y>=yHeroClick+this.map.tsize||this.x<=xHeroClick-this.map.tsize||this.y<=yHeroClick-this.map.tsize)&&(0==clickCanvasX&&0==clickCanvasY||(this.y=o*this.map.tsize+this.map.tsize/2,this.x=a*this.map.tsize+this.map.tsize/2),clickCanvasX=0,clickCanvasY=0),builds[a+"-"+o]){Game._getToolEquipe()!=builds[a+"-"+o].caracteristique.outilRecompense&&abs2[o*map.rows+a]==builds[a+"-"+o].batiment[3]?animBack=new animBackground(this.map,builds[a+"-"+o].x,builds[a+"-"+o].y,builds[a+"-"+o].caracteristique.outilRecompense+"_bulle"):animBack=null}else animBack=null},Hero.prototype._loselifeTile=function(i,t){var s=this.x-this.width/2,e=this.x+this.width/2-1,h=this.y-this.height/2,a=this.y+this.height/2-1,o=this.map.isLoseWinLife(s,h)||this.map.isLoseWinLife(e,h)||this.map.isLoseWinLife(e,a)||this.map.isLoseWinLife(s,a);"life"==o&&this.life<60&&(this.life=this.life+.1),1==o&&this.life>0&&(this.life=this.life-.1)},Hero.prototype._collide=function(i,t){var s,e,h=this.x-this.width/2,a=this.x+this.width/2-1,o=this.y-this.height/2,l=this.y+this.height/2-1;(this.map.isSolidTileAtXY(h,o)||this.map.isSolidTileAtXY(a,o)||this.map.isSolidTileAtXY(a,l)||this.map.isSolidTileAtXY(h,l))&&(t>0?(s=this.map.getRow(l),this.y=-this.height/2+this.map.getY(s)):t<0?(s=this.map.getRow(o),this.y=this.height/2+this.map.getY(s+1)):i>0?(e=this.map.getCol(a),this.x=-this.width/2+this.map.getX(e)):i<0&&(e=this.map.getCol(h),this.x=this.width/2+this.map.getX(e+1)))},Hero.prototype._ennemy=function(i,t){var s,e,h=this.x-this.width/2,a=this.x+this.width/2-1,o=this.y-this.height/2,l=this.y+this.height/2-1,n=this.map.isEnnemyTileAtXY(h,o)||this.map.isEnnemyTileAtXY(a,o)||this.map.isEnnemyTileAtXY(a,l)||this.map.isEnnemyTileAtXY(h,l);if(n){if(t>0?(s=this.map.getRow(l),this.y=-this.height/2+this.map.getY(s)):t<0?(s=this.map.getRow(o),this.y=this.height/2+this.map.getY(s+1)):i>0?(e=this.map.getCol(a),this.x=-this.width/2+this.map.getX(e)):i<0&&(e=this.map.getCol(h),this.x=this.width/2+this.map.getX(e+1)),this.life>0){var p=n.attaque-this.defense;p<0&&(p=.1);var m=this.attaque-n.defense;m<0&&(m=.1),this.life=this.life-p;var u=Game._getToolEquipe();n.life>0&&"epee"==u&&(n.life=n.life-m)}}else Object.keys(monsters).forEach(function(i){monsters[i].life<60&&(monsters[i].life=monsters[i].life+monsters[i].regeneration)})};