function Monstre(i,t,s,e,o,h,n,r,a,d,c,m,l,p){this.map=i,this.level=a,this.attaque=h,this.defense=n,this.regeneration=r,this.x=t,this.y=s,this.row=e,this.col=o,this.life=60,this.width=i.tsize,this.height=i.tsize,this.image=d,this.image1=d,this.image2=c,this.vitesse=m,this.directionX=l,this.directionY=p,this.collisionHero=0,this.name="monstre"+e+"-"+o}function generateTroll(i,t,s,e){this.nameTroll=new Monstre(map,i,t,s,e,22,18,.5,2,"troll3","troll2",0,0,0),monsters[s+"-"+e]=this.nameTroll}function generateMonstre(i,t,s,e,o,h,n,r,a,d,c,m,l,p){this.nameMonstre=new Monstre(i,t,s,e,o,h,n,r,a,d,c,m,l,p),monsters[e+"-"+o]=this.nameMonstre}Monstre.SPEED=50,Monstre.prototype.move=function(i,t,s){if(this.x+=this.directionX*this.vitesse*Monstre.SPEED*i,this.y+=this.directionY*this.vitesse*Monstre.SPEED*i,pos=this.map.getRow(this.y)*this.map.rows+this.map.getCol(this.x),1==this.directionX)var e=abs2[pos+1],o=abs1[pos+1],h=1;if(-1==this.directionX)var e=abs2[pos],o=abs1[pos],h=0;if(1==this.directionY)var e=abs2[pos+this.map.rows],o=abs1[pos+this.map.rows],h=1;if(-1==this.directionY)var e=abs2[pos],o=abs1[pos],h=0;1==this.directionY||-1==this.directionY?keyBatiment=parseInt(this.map.getRow(this.x),10)+"-"+parseInt(this.map.getCol(this.y)+h,10):keyBatiment=parseInt(this.map.getRow(this.x)+h,10)+"-"+parseInt(this.map.getCol(this.y),10),builds[keyBatiment]&&(builds[keyBatiment].life=builds[keyBatiment].life-this.attaque,builds[keyBatiment].life<=0?(posTuile=builds[keyBatiment].col*this.map.rows+builds[keyBatiment].row,abs2[posTuile]=2,anim=new animation(map,builds[keyBatiment].x,builds[keyBatiment].y,"cloud"),delete builds[keyBatiment]):(-1==this.directionX?this.directionX=1:1==this.directionX&&(this.directionX=-1),-1==this.directionY?this.directionY=1:1==this.directionY&&(this.directionY=-1)));var n=this.col+1,r=this.col-1,a=this.row+1,d=this.row-1,c=this.map.isHeroTileAtXY(t,s);if(0!=this.directionX&&(monsters[d+"-"+this.col]||monsters[a+"-"+this.col])||0!=this.directionY&&(monsters[this.row+"-"+r]||monsters[this.row+"-"+n]))return-1==this.directionX?this.directionX=1:1==this.directionX&&(this.directionX=-1),void(-1==this.directionY?this.directionY=1:1==this.directionY&&(this.directionY=-1));if(0==this.directionX&&0==this.directionY&&this.vitesse>0){var m=this.attaque-Game.hero.defense;m<0&&(m=.1),Game.hero.life=Game.hero.life-m}if((1==this.directionY||-1==this.directionY||0==this.directionY&&0==this.directionX)&&c[0]==this.map.getRow(this.x)&&(c[1]==n||c[1]==r||c[1]==this.map.getCol(this.y))||(1==this.directionX||-1==this.directionX||0==this.directionY&&0==this.directionX)&&c[1]==this.map.getCol(this.y)&&(c[0]==a||c[0]==d||c[0]==this.map.getRow(this.x)))0==this.collisionHero&&(this.collisionHero=1,olddirectionX=this.directionX,olddirectionY=this.directionY,this.directionX=0,this.directionY=0);else{1==this.collisionHero&&(this.directionX=olddirectionX,this.directionY=olddirectionY,this.collisionHero=0);(3===e||5===e||16===e||17===e||4===e&&3===o)&&(-1==this.directionX?this.directionX=1:1==this.directionX&&(this.directionX=-1),-1==this.directionY?this.directionY=1:1==this.directionY&&(this.directionY=-1));var l=this.map.cols*this.map.tsize,p=this.map.rows*this.map.tsize;this.x=Math.max(0,Math.min(this.x,l)),this.y=Math.max(0,Math.min(this.y,p)),this.col==Math.round(this.y/this.map.tsize)&&this.row==Math.round(this.x/this.map.tsize)||(monsters[Math.round(this.x/this.map.tsize)+"-"+Math.round(this.y/this.map.tsize)]=this,delete monsters[this.row+"-"+this.col]),this.row=Math.round(this.x/this.map.tsize),this.col=Math.round(this.y/this.map.tsize)}};